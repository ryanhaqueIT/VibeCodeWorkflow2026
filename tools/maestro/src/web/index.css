/**
 * Maestro Web Interface Styles
 *
 * Base styles and CSS custom properties for the web interface.
 * Theme colors are injected via JavaScript from ThemeProvider.
 */

@import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Fraunces:opsz,wght@9..144,600&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

/* CSS Custom Properties - Default values (overridden by theme) */
:root {
  /* Colors */
  --color-background: #1a1a2e;
  --color-surface: #16213e;
  --color-surface-elevated: #1f2e54;
  --color-border: #2d3a5a;
  --color-text-main: #eaeaea;
  --color-text-muted: #8892b0;
  --color-accent: #4a9eff;
  --color-accent-hover: #3a8eef;
  --color-success: #22c55e;
  --color-warning: #f59e0b;
  --color-error: #ef4444;

  /* Typography */
  --font-mono: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;

  /* Spacing */
  --spacing-xs: 4px;
  --spacing-sm: 8px;
  --spacing-md: 16px;
  --spacing-lg: 24px;
  --spacing-xl: 32px;

  /* Border Radius */
  --radius-sm: 4px;
  --radius-md: 8px;
  --radius-lg: 12px;
  --radius-full: 9999px;

  /* Transitions */
  --transition-fast: 150ms ease;
  --transition-normal: 200ms ease;
  --transition-slow: 300ms ease;

  /* Shell UI */
  --shell-bg: #f7f2ea;
  --shell-surface: #fffaf2;
  --shell-ink: #1b1b1b;
  --shell-muted: #5c5c5c;
  --shell-accent: #d9542f;
  --shell-accent-soft: #f3c5a4;
  --shell-teal: #0f6f73;
  --shell-border: #e5d8c7;
  --shell-shadow: 0 24px 60px rgba(16, 14, 10, 0.12);
  --shell-font: 'Space Grotesk', 'Segoe UI', sans-serif;
  --shell-display: 'Fraunces', 'Georgia', serif;

  /* Z-Index layers */
  --z-dropdown: 100;
  --z-sticky: 200;
  --z-modal-backdrop: 300;
  --z-modal: 400;
  --z-toast: 500;
}

/* Base styles */
html {
  font-size: 16px;
  -webkit-text-size-adjust: 100%;
}

body {
  font-family: var(--font-mono);
  background-color: var(--color-background);
  color: var(--color-text-main);
  line-height: 1.5;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.orchestrator-shell {
  position: relative;
  min-height: 100dvh;
  padding: 48px clamp(20px, 4vw, 56px) 56px;
  background: radial-gradient(circle at top left, #fef7ec 0%, #f6f0e6 45%, #ecf3ef 100%);
  color: var(--shell-ink);
  font-family: var(--shell-font);
  overflow: hidden;
}

.orchestrator-shell h1 {
  font-family: var(--shell-display);
  font-size: clamp(28px, 3vw, 40px);
  margin: 0;
  color: #2c1d12;
}

.shell-ambient {
  position: absolute;
  inset: auto;
  width: 280px;
  height: 280px;
  border-radius: 50%;
  filter: blur(40px);
  opacity: 0.35;
  z-index: 0;
  animation: float 12s ease-in-out infinite;
}

.shell-ambient--one {
  top: -80px;
  left: 10%;
  background: #f7c8a9;
}

.shell-ambient--two {
  bottom: -120px;
  right: 8%;
  background: #b8e0d2;
  animation-delay: -6s;
}

.shell-header,
.shell-stats,
.shell-grid {
  position: relative;
  z-index: 1;
}

.shell-header {
  display: flex;
  align-items: flex-end;
  justify-content: space-between;
  gap: 24px;
  margin-bottom: 28px;
}

.shell-eyebrow {
  text-transform: uppercase;
  letter-spacing: 0.18em;
  font-size: 12px;
  color: var(--shell-muted);
  margin-bottom: 10px;
}

.shell-header-actions {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}

.shell-button {
  padding: 10px 18px;
  border-radius: 999px;
  background: var(--shell-accent);
  color: #fffaf2;
  font-weight: 600;
  box-shadow: 0 12px 24px rgba(217, 84, 47, 0.28);
  transition: transform var(--transition-fast), box-shadow var(--transition-fast);
}

.shell-button:hover {
  transform: translateY(-1px);
  box-shadow: 0 18px 28px rgba(217, 84, 47, 0.3);
}

.shell-button--ghost {
  background: transparent;
  color: var(--shell-ink);
  border: 1px solid var(--shell-border);
  box-shadow: none;
}

.shell-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 16px;
  margin-bottom: 32px;
}

.shell-stat-card {
  background: var(--shell-surface);
  border: 1px solid var(--shell-border);
  border-radius: 20px;
  padding: 16px 18px;
  box-shadow: var(--shell-shadow);
}

.shell-stat-card p {
  margin: 0 0 6px;
  color: var(--shell-muted);
  font-size: 13px;
}

.shell-stat-card strong {
  font-size: 24px;
}

.shell-stat-card span {
  display: block;
  margin-top: 6px;
  color: var(--shell-muted);
  font-size: 12px;
}

.shell-grid {
  display: grid;
  grid-template-columns: minmax(220px, 280px) minmax(320px, 1fr) minmax(220px, 300px);
  gap: 18px;
}

.shell-panel {
  background: var(--shell-surface);
  border: 1px solid var(--shell-border);
  border-radius: 22px;
  padding: 18px;
  box-shadow: var(--shell-shadow);
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.shell-panel-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}

.shell-panel h2,
.shell-panel h3 {
  margin: 0;
  font-size: 16px;
}

.shell-link {
  color: var(--shell-teal);
  font-size: 13px;
  font-weight: 600;
}

.shell-list {
  display: grid;
  gap: 10px;
}

.shell-list-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: #fff3e7;
  border-radius: 16px;
  padding: 12px 14px;
}

.shell-item-title {
  font-weight: 600;
  margin: 0 0 4px;
}

.shell-item-meta {
  font-size: 12px;
  color: var(--shell-muted);
  margin: 0;
}

.shell-status {
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  padding: 4px 8px;
  border-radius: 999px;
  font-weight: 600;
}

.shell-status--in_progress,
.shell-status--running {
  background: #ffe0c2;
  color: #a9470c;
}

.shell-status--success {
  background: #d7f4e7;
  color: #1e7a57;
}

.shell-status--open {
  background: #e9e4dc;
  color: #5c5c5c;
}

.shell-session-grid {
  display: grid;
  gap: 12px;
}

.shell-session-card {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 14px;
  border-radius: 18px;
  border: 1px solid #f0e1d0;
  background: #fff7ef;
}

.shell-session-meta {
  display: grid;
  gap: 6px;
  text-align: right;
}

.shell-timer {
  font-size: 12px;
  color: var(--shell-muted);
}

.shell-log {
  background: #1f1a15;
  color: #f7f2ea;
  border-radius: 18px;
  padding: 16px;
}

.shell-log-stream {
  margin: 0;
  font-family: var(--font-mono);
  font-size: 12px;
  color: #f7e6d4;
  white-space: pre-wrap;
}

.shell-inspector-card {
  background: #fff4e6;
  border-radius: 18px;
  padding: 16px;
  display: grid;
  gap: 10px;
}

.shell-inspector-card--secondary {
  background: #e9f3ef;
}

.shell-divider {
  height: 1px;
  background: var(--shell-border);
}

.shell-kv {
  display: flex;
  justify-content: space-between;
  font-size: 13px;
}

.shell-chip-row {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.shell-chip {
  padding: 6px 10px;
  border-radius: 999px;
  background: #ffe9d3;
  font-size: 12px;
  font-weight: 600;
}

.shell-chip--muted {
  background: #f1ece4;
  color: var(--shell-muted);
}

.shell-reveal {
  opacity: 0;
  transform: translateY(12px);
  animation: reveal 600ms ease forwards;
}

.shell-reveal--1 {
  animation-delay: 80ms;
}

.shell-reveal--2 {
  animation-delay: 140ms;
}

.shell-reveal--3 {
  animation-delay: 220ms;
}

@keyframes float {
  0%, 100% {
    transform: translateY(0px);
  }
  50% {
    transform: translateY(16px);
  }
}

@keyframes reveal {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@media (max-width: 1100px) {
  .shell-grid {
    grid-template-columns: 1fr;
  }

  .shell-panel--list,
  .shell-panel--inspector {
    order: 2;
  }
}

/* Selection styling */
::selection {
  background-color: var(--color-accent);
  color: white;
}

/* Scrollbar styling */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--color-surface);
}

::-webkit-scrollbar-thumb {
  background: var(--color-border);
  border-radius: var(--radius-full);
}

::-webkit-scrollbar-thumb:hover {
  background: var(--color-text-muted);
}

/* Focus styles */
:focus-visible {
  outline: 2px solid var(--color-accent);
  outline-offset: 2px;
}

/* Remove default focus outline (we use focus-visible) */
:focus:not(:focus-visible) {
  outline: none;
}

/* Link styles */
a {
  color: var(--color-accent);
  text-decoration: none;
  transition: color var(--transition-fast);
}

a:hover {
  color: var(--color-accent-hover);
}

/* Button reset */
button {
  font-family: inherit;
  font-size: inherit;
  cursor: pointer;
  background: none;
  border: none;
  padding: 0;
}

/* Input reset */
input,
textarea,
select {
  font-family: inherit;
  font-size: inherit;
  background: none;
  border: none;
}

/* Mobile-specific styles */
@media (max-width: 767px) {
  /* Prevent text size adjustment */
  html {
    -webkit-text-size-adjust: none;
    text-size-adjust: none;
  }

  /* Larger tap targets for accessibility (44px minimum per Apple HIG) */
  button,
  a,
  input,
  select,
  textarea {
    min-height: 44px;
  }

  /* Disable pull-to-refresh on body (we'll handle it ourselves) */
  body {
    overscroll-behavior-y: contain;
  }

  /* Prevent zoom on input focus (iOS Safari) */
  input,
  textarea,
  select {
    font-size: 16px !important;
  }
}

/* Dynamic viewport height support for mobile browsers */
/* dvh accounts for mobile browser chrome (address bar) */
html, body, #root {
  min-height: 100dvh;
  min-height: -webkit-fill-available;
}

/* Fallback for browsers that don't support dvh */
@supports not (min-height: 100dvh) {
  html, body, #root {
    min-height: 100vh;
  }
}

/* iOS-specific fixes */
@supports (-webkit-touch-callout: none) {
  /* Fix for iOS rubber-banding */
  body {
    position: fixed;
    width: 100%;
    height: 100%;
    overflow: hidden;
  }

  #root {
    height: 100%;
    overflow: auto;
    -webkit-overflow-scrolling: touch;
  }

  /* Prevent iOS zoom on double tap */
  * {
    touch-action: manipulation;
  }
}

/* Prevent touch callout (long-press menu) on interactive elements */
button,
a,
input,
select,
textarea {
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
}

/* Allow text selection in content areas */
p, span, div, article, section {
  -webkit-user-select: text;
  user-select: text;
}

/* Smooth momentum scrolling */
.scrollable {
  -webkit-overflow-scrolling: touch;
  overflow-y: auto;
}

/* Safe area insets for iOS */
@supports (padding-top: env(safe-area-inset-top)) {
  .safe-area-top {
    padding-top: env(safe-area-inset-top);
  }

  .safe-area-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }

  .safe-area-left {
    padding-left: env(safe-area-inset-left);
  }

  .safe-area-right {
    padding-right: env(safe-area-inset-right);
  }
}

/* Animation keyframes */
@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

@keyframes pulse {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slideUp {
  from {
    transform: translateY(100%);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

@keyframes slideDown {
  from {
    transform: translateY(-100%);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

/* Utility classes */
.animate-spin {
  animation: spin 1s linear infinite;
}

.animate-pulse {
  animation: pulse 2s ease-in-out infinite;
}

.animate-fadeIn {
  animation: fadeIn var(--transition-normal);
}

.animate-slideUp {
  animation: slideUp var(--transition-normal);
}

.animate-slideDown {
  animation: slideDown var(--transition-normal);
}

/* Hide scrollbar but keep functionality */
.scrollbar-hide {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

.scrollbar-hide::-webkit-scrollbar {
  display: none;
}

/* Truncate text */
.truncate {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* Line clamp */
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.line-clamp-3 {
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Restore list styling for markdown preview prose containers */
.prose ul {
  list-style-type: disc !important;
  list-style-position: outside !important;
}

.prose ol {
  list-style-type: decimal !important;
  list-style-position: outside !important;
}

.prose li {
  display: list-item !important;
}

/* Fix bullet alignment when first element is bold/styled */
.prose li > strong:first-child,
.prose li > b:first-child,
.prose li > em:first-child,
.prose li > code:first-child,
.prose li > a:first-child {
  vertical-align: baseline;
  line-height: inherit;
}

.prose li::marker {
  font-weight: normal;
}

/* Nested lists */
.prose ul ul {
  list-style-type: circle !important;
}

.prose ul ul ul {
  list-style-type: square !important;
}

.prose ol ol {
  list-style-type: lower-alpha !important;
}

.prose ol ol ol {
  list-style-type: lower-roman !important;
}
